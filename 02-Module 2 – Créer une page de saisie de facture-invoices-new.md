# <h1 id="module-2">Module 2 – Création du formulaire « Create Invoice » (`/invoices/new`)</h1>



## <h2 id="objectif">Objectif pédagogique</h2>

À la fin de ce module, l’étudiant doit être capable de :

1. Vérifier ou installer Tailwind CSS dans un projet Next 15.
2. Générer une route **App Router** pour `/invoices/new`.
3. Installer et utiliser des composants **`shadcn/ui`**.
4. Construire un formulaire complet, stylé et fonctionnel.
5. Préparer l’intégration de **React Hook Form** en vue de la validation et de la soumission.

---

## <h2 id="prerequis">Pré-requis techniques</h2>

* **Node ≥ 18** et **npm** (ou pnpm / yarn).
* Projet Next 15 déjà généré :

  ```bash
  npx create-next-app@latest my-invoicing-app
  ```
* Option *Tailwind CSS* cochée **Yes** lors de la génération.

  > Si ce n’est pas le cas, suivre la **section A** (Installation manuelle de Tailwind) avant de passer à la suite.
  > Mise à jour : Même si c'est installé, TailwindCSS v4 est encore en développement. Pour la production, utilisez toujours TailwindCSS v3 qui est stable et bien testé. Donc, suivez la Section A

---

## <h2 id="section-a">Section A – Installation manuelle de Tailwind (si absent)</h2>

1. Installer les dépendances :

   ```bash
   npm install -D tailwindcss postcss autoprefixer
   npm list tailwindcss
   npm uninstall tailwindcss @tailwindcss/postcss
   npm list tailwindcss
   npm install -D tailwindcss@^3.4.0
   npm list tailwindcss
   npx tailwindcss init -p
   ```


![image](https://github.com/user-attachments/assets/8a91e9fd-da8e-462c-bf8f-7c28ec64b0c5)


2. Vérifiez le fichier postcss.config.mjs


```bash
const config = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};

export default config;
```


3. Vérifiez le Fichier de configuration TailwindCS - Modifier `tailwind.config.ts` et mettre à joir le css global :

```ts
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    './src/pages/**/*.{js,ts,jsx,tsx,mdx}',
    './src/components/**/*.{js,ts,jsx,tsx,mdx}',
    './src/app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {
      fontFamily: {
        sans: ['var(--font-geist-sans)'],
        mono: ['var(--font-geist-mono)'],
      },
      colors: {
        background: 'var(--background)',
        foreground: 'var(--foreground)',
      },
    },
  },
  plugins: [],
} 
```

4. Vérifier / créer `src/app/globals.css` et y placer :

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --background: #ffffff;
  --foreground: #171717;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}

body {
  color: var(--foreground);
  background: var(--background);
  font-family: Arial, Helvetica, sans-serif;
}
```

5. Redémarrer le serveur de développement :

```bash
npm run dev
```


6. En cas de problème, il faut ajouter suppressHydrationWarning sur la balise <html>. Cela indique à React d'ignorer les différences d'hydratation uniquement sur cette balise, ce qui résoudra l'erreur causée par l'attribut data-google-analytics-opt-out.

7. Modifiez page.tsx et layout.tsx

### page.tsx

```bash
export default function Home() {
  return (
    <main className="min-h-screen p-8 bg-gradient-to-br from-blue-50 to-indigo-100">
      <div className="max-w-4xl mx-auto">
        <h1 className="text-4xl font-bold text-gray-800 mb-6">
          Bienvenue sur My Invoicing App
        </h1>
        <div className="bg-white rounded-lg shadow-lg p-6">
          <p className="text-gray-600 mb-4">
            TailwindCSS v3 est maintenant configuré et fonctionne parfaitement !
          </p>
          <div className="flex gap-4">
            <button className="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors">
              Test Button 1
            </button>
            <button className="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded transition-colors">
              Test Button 2
            </button>
          </div>
        </div>
      </div>
    </main>
  );
}
```

### layout.tsx
```bash
import type { Metadata } from "next";
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en" suppressHydrationWarning>
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        {children}
      </body>
    </html>
  );
}

```

8. Redémarrer le serveur de développement :

```bash
npm run dev
```

9. En cas de problèmes

git clone https://github.com/hrhouma1/hello-next-tailwind.git
cd hello-next-tailwind
npm run dev
---

## <h2 id="etape-1">Étape 1 – Création de l’arborescence `/invoices/new`</h2>

1. Dans `src/app`, créer les dossiers :

   ```
   invoices/
     └── new/
         └── page.tsx
   ```

2. Contenu minimal de `page.tsx` (test de la route) :

   ```tsx
   export default function Page() {
     return <h1 className="text-3xl font-bold">Create Invoice</h1>;
   }
   ```

3. Vérification :
   Naviguer vers `http://localhost:3000/invoices/new`.
   Le titre « Create Invoice » doit s’afficher.

---

## <h2 id="etape-2">Étape 2 – Installation des composants `shadcn/ui`</h2>

1. Initialiser le CLI (si ce n’est pas encore fait) :

   ```bash
   npx shadcn@latest init
   # Répondre aux invites : TypeScript ? → yes, Tailwind → yes, Directory → src
   ```

2. Ajouter les composants nécessaires au formulaire :

   ```bash
   npx shadcn@latest add input label textarea button
   ```

   Des fichiers apparaissent dans `src/components/ui/`.

---

## <h2 id="etape-3">Étape 3 – Formulaire statique (version fonctionnelle + styles exacts)</h2>

Copier entièrement ce code dans `src/app/invoices/new/page.tsx` :

```tsx
import { Label } from "@/components/ui/label";
import { Input } from "@/components/ui/input";
import { Textarea } from "@/components/ui/textarea";
import { Button } from "@/components/ui/button";

export default function Page() {
  return (
    <main className="p-10 max-w-xl mx-auto">
      <h1 className="text-3xl font-bold mb-8">Create a New Invoice</h1>

      <form className="space-y-6">
        {/* Billing Name */}
        <div>
          <Label htmlFor="name" className="block font-semibold text-sm mb-2">
            Billing Name
          </Label>
          <Input id="name" name="name" type="text" className="w-full" />
        </div>

        {/* Billing Email */}
        <div>
          <Label htmlFor="email" className="block font-semibold text-sm mb-2">
            Billing Email
          </Label>
          <Input id="email" name="email" type="email" className="w-full" />
        </div>

        {/* Value */}
        <div>
          <Label htmlFor="value" className="block font-semibold text-sm mb-2">
            Value
          </Label>
          <Input id="value" name="value" type="number" className="w-full" />
        </div>

        {/* Description */}
        <div>
          <Label
            htmlFor="description"
            className="block font-semibold text-sm mb-2"
          >
            Description
          </Label>
          <Textarea
            id="description"
            name="description"
            rows={4}
            className="w-full"
          />
        </div>

        {/* Submit */}
        <div>
          <Button type="submit" className="w-full font-semibold">
            Submit
          </Button>
        </div>
      </form>
    </main>
  );
}
```

### Contrôle de fonctionnement

1. Lancer `npm run dev` (ou laisser tourner).
2. Rafraîchir `http://localhost:3000/invoices/new`.
3. Vérifier :

   * Alignement à gauche du titre et du formulaire.
   * Champs pleine largeur (`w-full`).
   * Bouton noir (`Button` shadcn par défaut) pleine largeur, texte en gras.

---

## <h2 id="etape-4">Étape 4 – Préparation à React Hook Form</h2>

1. Installer :

   ```bash
   npm install react-hook-form
   ```

2. Concepts à maîtriser (lecture obligatoire avant la prochaine séance) :

   | Fonction           | Rôle                                              |
   | ------------------ | ------------------------------------------------- |
   | `useForm()`        | Initialise le contexte du formulaire              |
   | `register()`       | Lie un champ HTML/React au state interne          |
   | `handleSubmit(fn)` | Exécute `fn` si la validation passe               |
   | `formState.errors` | Objet listant les erreurs de validation par champ |

